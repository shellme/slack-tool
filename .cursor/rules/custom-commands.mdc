---
description: カスタムコマンド作成のベストプラクティスとガイドライン
globs: [".cursor/commands/*.md", ".cursor/scripts/*.sh"]
alwaysApply: false
---

# カスタムコマンド作成ルール

## 基本原則

### デュアルユーザー対応
カスタムコマンドは以下の両方に対応する必要がある：
- **AIアシスタント向け**: 明確な実行指示とスクリプトパス
- **人間向け**: 手動実行の手順とトラブルシューティング

### ファイル構成
```
.cursor/
├── commands/           # コマンドドキュメント
│   ├── command-name.md # 各コマンドの説明
└── scripts/           # 実行スクリプト
    ├── command-name.sh # 実際の処理
    └── helper-name.sh  # ヘルパースクリプト
```

## コマンドドキュメントの構成

### 必須セクション
1. **概要** - コマンドの目的と機能
2. **使用方法** - `/command [args]` 形式
3. **パラメータ** - 各引数の説明
4. **例** - 具体的な使用例
5. **実行方法** - AIアシスタントへの指示
6. **手動実行** - 人間向けの直接実行手順
7. **注意事項** - 重要な制約や前提条件

### 推奨セクション
- **トラブルシューティング** - よくある問題と解決方法
- **ヘルパーコマンド** - 関連する他のコマンド
- **実行内容** - 処理の詳細ステップ

## スクリプトの要件

### エラーハンドリング
- 引数チェック
- 実行前の状態確認
- 適切なエラーメッセージ
- 終了コードの設定

### ユーザビリティ
- 進行状況の表示
- 実行結果の確認
- ヘルプメッセージの提供

### セキュリティ
- 入力値の検証
- 権限チェック
- 安全なファイル操作

## 命名規則

### コマンド名
- 小文字とハイフンを使用: `release`, `version-helper`
- 動詞ベース: `create`, `update`, `delete`
- 明確で簡潔: `build` より `compile` の方が具体的

### ファイル名
- コマンドドキュメント: `command-name.md`
- 実行スクリプト: `command-name.sh`
- ヘルパースクリプト: `helper-name.sh`

## ドキュメントの書き方

### AIアシスタント向け
```markdown
## 実行方法
このコマンドが実行された場合、以下のスクリプトを実行してください：
```bash
./.cursor/scripts/command-name.sh [args]
```
```

### 人間向け
```markdown
## 手動実行（人間向け）
```bash
# 直接スクリプトを実行
./.cursor/scripts/command-name.sh [args]

# ヘルパーコマンド
./.cursor/scripts/helper-name.sh [args]
```
```

## 品質チェックリスト

### ドキュメント
- [ ] 使用方法が明確
- [ ] 例が具体的で実用的
- [ ] エラーケースが説明されている
- [ ] トラブルシューティングが含まれている

### スクリプト
- [ ] 引数チェックが実装されている
- [ ] エラーハンドリングが適切
- [ ] 実行権限が設定されている
- [ ] ログ出力が適切

### 統合
- [ ] ドキュメントとスクリプトが一致
- [ ] パスが正しく設定されている
- [ ] 依存関係が明確

## 例: 良いコマンドドキュメント

```markdown
# リリースコマンド

## 概要
プロジェクトのリリース作業を自動化するコマンドです。

## 使用方法
```
/release [version] [message]
```

## パラメータ
- `version`: リリースするバージョン（例: v0.6.0, patch, minor, major）
- `message`: リリースメッセージ（省略可）

## 例
```
/release v0.6.0 "新しい機能を追加"
/release patch "バグ修正"
```

## 実行方法
このコマンドが実行された場合、以下のスクリプトを実行してください：
```bash
./.cursor/scripts/release.sh [version] [message]
```

## 手動実行（人間向け）
```bash
./.cursor/scripts/release.sh v0.6.0 "新しい機能を追加"
```

## 注意事項
- mainブランチで実行してください
- コミット前にテストを実行してください

## トラブルシューティング
- リリースが失敗した場合: `git tag -d [version]` でタグを削除して再実行
```